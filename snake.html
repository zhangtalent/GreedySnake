<html  style="width:100%;height:100%;">

	
	<head>
			<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
	</head>

	<body style="width:100%;height:100%;text-align:center;">
		<canvas style="background-color:87CEFA;" id="cv"></canvas>
		<div style="width:300px;position:fixed;z-index:99;bottom:15px;right:15px;">
			<button style="width:100px;height:100px;" onclick="snakeup()">ğŸ‘†</button><br>
			<button style="width:100px;height:100px;"  onclick="snakeleft()">ğŸ‘ˆ</button>
			<button style="margin-left:70px;width:100px;height:100px;"  onclick="snakeright()">ğŸ‘‰</button><br>
			<button style="width:100px;height:100px;" onclick="snakedown()">ğŸ‘‡</button>
		</div>	
		
	</body>
	
	
	<script>
		var width = document.body.clientWidth;
		var height = document.body.clientHeight;
		var click = 0;
		var hsize = 0;
		var vsize = 0;
		var foodInScreen = 0;
		//ä¸€å±‚çš„æ°´ç®¡çš®è‚¤
		var pipeLine = [0,1,4,4,4,4,4,4,1,0];
		//é¢œè‰²é›†åˆ
		//0é€æ˜1é»‘è‰²2çº¢è‰²3é»„è‰²4ç»¿è‰²5è“è‰²6ç™½è‰²7ç°è‰²
		var colors=["#","black","red","yellow","green","blue","white","gray"];
		var cx = document.getElementById("cv");
		var startbtX = width/2;
		if(width>1000){
			cx.width = 1000;
			startbtX = 150;
			hsize = 20;
		}
		else{
			var q = parseInt(width/50);
			cx.width = q*50;
			var edge = (width-50*q)/2;
			//cx.style.marginLeft = edge;
			hsize = q;
		}
		
		var p = parseInt(height/50);
		cx.height = p*50;
		var edge = (height-50*p)/2;
		//cx.style.marginTop = edge;	
		vsize = p;
		//cx.height = height;
		//æœ€å¤§åƒç´ å°ºå¯¸
		var MaxEdgeSize = parseInt(height/80);
		var ctx=cx.getContext("2d") //create 2d object
		//æ¸¸æˆæŒ‰é’®åæ ‡
		
		var startbtY = height-150;
		console.log(startbtX,startbtY)
		//æ˜¯å¦å†æ¸¸æˆ
		var isgaming = 0;
		//è›‡èº«ä½“çš„ä½ç½®é›†åˆ
		var snakes = [];
		//äººç‰©ä½ç½®
		var foodpos = [];
		//é€Ÿåº¦
		var speed = 1;
		//è®¡ç®—
		var count = 0;
		var blocksize = 50;
		var score = 0;
		//æ¸¸æˆè¿è¡Œ
		//ä½ç½® 2ä¸‹4å·¦6æœ‰8ä¸Š
		var w = 6;
		var interval = setInterval(gaming, 100); //å¯åŠ¨,funcä¸èƒ½ä½¿ç”¨æ‹¬å·
		clearInterval(interval );//åœæ­¢
		function gaming(){
			if(count%300 == 0){count = 0;speed+=1;}
			count++;
			//ç”» æ¸…ç”»å¸ƒ
			ctx.clearRect(0,0,cx.width,cx.height); 
			var size = snakes.length;
			//æ²¡é£Ÿç‰©è¯åäº”
			if(foodInScreen==0){
				foodpos = makefood(hsize,vsize);
				console.log('---å¤±è¯¯',foodpos[0],foodpos[1])
				foodInScreen = 1;
			}else{
				//ctx.font="70px Arial";
				ctx.fillStyle=colors[3];
				ctx.fillRect(foodpos[0]*blocksize,foodpos[1]*blocksize,blocksize,blocksize);	
			}

				//å‘å³ä¸”è¶…å‡ºé™å®šå¤§å°å¤±è´¥
				if(w == 6){
					if(((snakes[0][0])+1) >= hsize){
						startgames(1);
						//break;
					}else{
						//å¦‚æœåƒåˆ°é£Ÿç‰©ã€‚æ·»åŠ è¿›snakeï¼Œä¸ç„¶å°±ç»§ç»­ç§»åŠ¨
						if(((snakes[0][0])+1)==foodpos[0] && snakes[0][1] == foodpos[1]){
							foodInScreen = 0;
							drawSnake(1,foodpos[0],foodpos[1])
							//break;
						}
						for(var j = 1;j<size;j++){
							if(((snakes[0][0])+1)==snakes[j][0]&& snakes[0][1] == snakes[j][1]){
								startgames(1);
								break;
							}
						}
						drawSnake(0,snakes[0][0]+1,snakes[0][1])
					}
				}
				//å·¦
				if(w == 4){
				
					if(((snakes[0][0])-1) < 0){
						startgames(1);
						//break;
					}else{
						//å¦‚æœåƒåˆ°é£Ÿç‰©ã€‚æ·»åŠ è¿›snakeï¼Œä¸ç„¶å°±ç»§ç»­ç§»åŠ¨
						if(((snakes[0][0])-1)==foodpos[0] && snakes[0][1] == foodpos[1]){
							foodInScreen = 0;
							drawSnake(1,foodpos[0],foodpos[1])
							//break;
						}
						for(var j = 1;j<size;j++){
							if(((snakes[0][0])-1)==snakes[j][0]&& snakes[0][1] == snakes[j][1]){
								startgames(1);
								break;
							}
						}
						drawSnake(0,snakes[0][0]-1,snakes[0][1])
					}
				}
				//ä¸‹
				if(w == 2){
					
					if(((snakes[0][1])+1) >= vsize){
						startgames(1);
						//break;
					}else{
						//å¦‚æœåƒåˆ°é£Ÿç‰©ã€‚æ·»åŠ è¿›snakeï¼Œä¸ç„¶å°±ç»§ç»­ç§»åŠ¨
						if(((snakes[0][1])+1)==foodpos[1] && snakes[0][0] == foodpos[0]){
							foodInScreen = 0;
							drawSnake(1,foodpos[0],foodpos[1])
							//break;
						}
						for(var j = 1;j<size;j++){
							if(((snakes[0][1])+1)==snakes[j][1]&& snakes[0][0] == snakes[j][0]){
								startgames(1);
								break;
							}
						}
						drawSnake(0,snakes[0][0],snakes[0][1]+1)
					}
				}
				//ä¸Š
				if(w == 8){
					if(((snakes[0][1])-1) < 0){
						startgames(1);
						//break;
					}else{
						//å¦‚æœåƒåˆ°é£Ÿç‰©ã€‚æ·»åŠ è¿›snakeï¼Œä¸ç„¶å°±ç»§ç»­ç§»åŠ¨
						if(((snakes[0][1])-1)==foodpos[1] && snakes[0][0] == foodpos[0]){
							foodInScreen = 0;
							drawSnake(1,foodpos[0],foodpos[1])
							//break;
						}
						for(var j = 1;j<size;j++){
							if(((snakes[0][1])-1)==snakes[j][1]&& snakes[0][0] == snakes[j][0]){
								startgames(1);
								break;
							}
						}
						drawSnake(0,snakes[0][0],snakes[0][1]-1)
					}
				}

			 
			
		} //å®šæ—¶ä»»åŠ¡	
		
		//ç‚¹å‡»äº‹ä»¶
		cx.onclick = function(event){
			//var event = event || window.event;
			var x = event.pageX - cx.getBoundingClientRect().left;
			var y = event.pageY - cx.getBoundingClientRect().top;
            var pos = {'x':x,'y':y}
			console.log(pos.x,pos.y)
			click = 1;
			//æ˜¯å¦è§¦å‘æ¸¸æˆå¼€å§‹
			if(pos.x>=startbtX-50&&pos.x<=startbtX+250&&pos.y>=startbtY-50&&pos.y<=startbtY+150&&isgaming==0){
				//alert('Game start')
				//ç”» æ¸…ç”»å¸ƒ
				ctx.clearRect(0,0,cx.width,cx.height);  
				var curX = parseInt(Math.random()*(hsize-3))
				var curY = parseInt(Math.random()*(vsize-3))
				snakes.push([curX,curY]);
				drawBlock(curX,curY,50);
				interval = setInterval(gaming, 100); //å¯åŠ¨,funcä¸èƒ½ä½¿ç”¨æ‹¬å·
				isgaming = 1;
			}
			
		}
		
		
		//å¼€å§‹æ¸¸æˆæŒ‰é’®è®¾å®š
		function startgames(flag){
			//flagä¸º0è¡¨ç¤ºç¬¬ä¸€æ¬¡ç©ï¼Œ1ä¸ºå¤±è´¥é‡æ–°æ¸¸æˆ	
			if(flag == 0){
				ctx.font="70px Arial";
				ctx.font="70px Arial";
				ctx.fillStyle=colors[6];
				ctx.fillText("Start Game",startbtX,startbtY);
				ctx.fillText("å¼ å¤©æ‰çš„è´ªåƒè›‡",startbtX-130,startbtY-300);
			}else{
				isgaming = 0;
				snakes = [];
				foodpos = [];
				speed = 1;
				count = 0;
				ctx.font="70px Arial";
				ctx.font="70px Arial";
				ctx.fillStyle=colors[6];
				
				ctx.fillText("æ¸¸æˆç»“æŸ:"+score+"åˆ†",startbtX-130,startbtY-300);
				ctx.fillText("Restart Game",startbtX,startbtY);
				score = 0;
				clearInterval(interval );//åœæ­¢
			}
			
		}
		
		startgames(0);
		//ç”Ÿæˆé£Ÿç‰©ä½ç½®
		function makefood(hsize,vsize){
			var curX = parseInt(Math.random()*hsize)
			var curY = parseInt(Math.random()*vsize)
			//ctx.font="3px Arial";
			//ctx.fillStyle=colors[6];
			//ctx.fillText("$",curX*blocksize+10,curY*blocksize+10);
			ctx.fillStyle=colors[3];
			ctx.fillRect(curX*blocksize,curY*blocksize,blocksize,blocksize);	
			return [curX,curY]
		}
		
		function snakeup(){
			w = 8;
		}
		function snakedown(){
			w = 2;
		}
		function snakeleft(){
			w = 4;
		}
		function snakeright(){
			w = 6;
		}
		
		
		//ç”»ç­·å‡½æ•°
		function drawBlock(X,Y,blocksize){
					ctx.fillStyle=colors[1];
					ctx.fillRect(X*blocksize,Y*blocksize,blocksize,blocksize);	
		}	
		
		function drawSnake(isfood,x,y){
			if(isfood == 1){
				snakes.push([x,y]);
				score++;
				var cursize = snakes.length;
				for(var i= cursize-1;i>0;i--){
					snakes[i] = snakes[i-1];
					//drawBlock(snakes[i][0],snakes[i][1],50);
				}
				snakes[0] = [x,y];
				drawBlock(snakes[0][0],snakes[0][1],50);
			}else{
				var cursize = snakes.length;
				for(var i= cursize-1;i>0;i--){
					snakes[i] = snakes[i-1];
					drawBlock(snakes[i][0],snakes[i][1],50);
				}
				snakes[0] = [x,y];
				drawBlock(snakes[0][0],snakes[0][1],50);
			}
		}
	</script>
	
</html>